<!DOCTYPE html>
<html lang="en">

<head>
 <title></title>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
 <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css' />
 <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
  crossorigin="anonymous"></script>
 <style>
  .no-underline {
   border-bottom: none !important;
  }

  .fa-trash,
  .fa-check {
   pointer-events: none;
  }

  .bg-color-1 {
   background-color: #DFCFBE !important;
  }

  .bg-color-2 {
   background-color: #55b4b0 !important;
  }

  .text-color-1 {
   color: #2081f0
  }
 </style>
</head>

<body class="bg-dark">
 <div class="">

  <table class="table text-center w-50 mx-auto my-5 bg-color-1 w3-food-butter align-items-center">
   <thead>
    <tr class="">
     <th scope="col" colspan="8" class="h2">MAYO</th>
    </tr>
   </thead>
   <tr class="h4 bg-color-2 align-items-center">
    <th scope="col" class="col-1">Lunes</th>
    <th scope="col" class="col-1">Martes</th>
    <th scope="col" class="col-1">Miercoles</th>
    <th scope="col" class="col-1">Jueves</th>
    <th scope="col" class="col-1">Viernes</th>
    <th scope="col" class="col-1">Sabado</th>
    <th scope="col" class="col-1">Domingo</th>
    <th scope="col" class="col-1">Total Por Semana</th>
   </tr>
   <tbody id="table-body-to-fill">
    <!-- /////////////////////////////////// -->
    <!-- LINEAS DE NUMEROS DE DIAS Y BOTONES -->
    <!-- /////////////////////////////////// -->
    <tr class="h4">
     <td scope="col" class="no-underline">-</td>
     <td scope="col" class="no-underline">-</td>
     <td scope="col" class="no-underline">-</td>
     <td scope="col" class="no-underline">-</td>
     <td scope="col" class="no-underline">-</td>
     <td scope="col" class="no-underline">-</td>
     <td scope="col" class="no-underline">-</td>
     <td rowspan="2" scope="col"></td>
    </tr>
    <tr class="">
     <td scope="col"><button class="btn">

       <i class="far fa-smile-beam h2 text-color-1"></i>

       <i class="fas fa-money-bill-wave h3 text-success"></i>

      </button></td>
     <td scope="col"><button class="btn"><i class="fas fa-exclamation-triangle"></i></button></td>
     <td scope="col"><button class="btn"><i class="fas fa-exclamation-triangle"></i></button></td>
     <td scope="col"><button class="btn"><i class="fas fa-exclamation-triangle"></i></button></td>
     <td scope="col"><button class="btn"><i class="fas fa-exclamation-triangle"></i></button></td>
     <td scope="col"><button class="btn"><i class="fas fa-exclamation-triangle"></i></button></td>
     <td scope="col"><button class="btn"><i class="fas fa-exclamation-triangle"></i></button></td>
    </tr>


   </tbody>
  </table>


  <script>
   /* ////////////////////////////////////////////// */
   /* JQUERY INICIO */
   /* ////////////////////////////////////////////// */
   $(document).ready(function () {


    /* ////////////////////////////////////////////// */
    /* CARGA / ESCRITURA INICIAL DE DATOS*/
    /* ////////////////////////////////////////////// */
    let mainData = JSON.parse(localStorage.getItem('mainData'))

    if (mainData === null) {
     let meses = {
      mayo: [
       { semana: [[0, '-', 0], [0, '-', 1], [0, '-', 2], [0, '-', 3], [0, '-', 4], [0, '-', 5], [0, 1, 6]] },
       { semana: [[0, 2, 7], [0, 3, 8], [0, 4, 9], [0, 5, 10], [0, 6, 11], [0, 7, 12], [0, 8, 13]] },
       { semana: [[0, 9, 14], [0, 10, 15], [0, 11, 16], [0, 12, 17], [0, 13, 18], [0, 14, 19], [0, 15, 20]] },
       { semana: [[0, 16, 21], [0, 17, 22], [0, 18, 23], [0, 19, 24], [0, 20, 25], [0, 21, 26], [0, 22, 27]] },
       { semana: [[0, 23, 28], [0, 24, 29], [0, 25, 30], [0, 26, 31], [0, 27, 32], [0, 28, 33], [0, 29, 34]] },
       { semana: [[0, 30, 35], [0, 31, 36], [0, '-', 37], [0, '-', 38], [0, '-', 39], [0, '-', 40], [0, '-', 41]] },
      ]
     }
     localStorage.setItem('mainData', JSON.stringify(meses))

    } else {

     mainData = JSON.parse(localStorage.getItem('mainData'))

    }
    /* ////////////////////////////////////////////// */
    /* COMPLETAR LA TABLA CON DATOS DEL LOCALSTORAGE */
    /* ////////////////////////////////////////////// */
    function completarTablaPorMes() {

     mainData = JSON.parse(localStorage.getItem('mainData'))

     /*      let semanas_checksHTML = mainData.mayo.reduce((acc, semana, index) => {
     
           return acc +=
            `
         <tr class="h3">
          <td scope="col" class="no-underline">${semana.semana[0][1]}</td>
          <td scope="col" class="no-underline">${semana.semana[1][1]}</td>
          <td scope="col" class="no-underline">${semana.semana[2][1]}</td>
          <td scope="col" class="no-underline">${semana.semana[3][1]}</td>
          <td scope="col" class="no-underline">${semana.semana[4][1]}</td>
          <td scope="col" class="no-underline">${semana.semana[5][1]}</td>
          <td scope="col" class="no-underline">${semana.semana[6][1]}</td>
          <td rowspan="2" scope="col"></td>
         </tr>
         <tr class="">
          <td scope="col"><button class="btn" id="${semana.semana[0][2]}"><i class="fas fa-exclamation-triangle h2  text-danger"></i></button></td>
          <td scope="col"><button class="btn" id="${semana.semana[1][2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
          <td scope="col"><button class="btn" id="${semana.semana[2][2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
          <td scope="col"><button class="btn" id="${semana.semana[3][2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
          <td scope="col"><button class="btn" id="${semana.semana[4][2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
          <td scope="col"><button class="btn" id="${semana.semana[5][2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
          <td scope="col"><button class="btn" id="${semana.semana[6][2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
         </tr>
         `
          }, '') */


     let semanas_checksHTML = mainData.mayo.reduce((acc, semana, index) => {
      let sumaPorSemana = 0

      // console.log(semana)
      let semanaHTML = ''

      semanaHTML += ` <tr class="">`
      semana.semana.map((dia, index) => {

       if (dia[0] === 666) {
        console.log(dia)
        console.log(dia[0])
        console.log(dia[1])
        console.log(dia[2])
        console.log('index = ' + index)
        sumaPorSemana += 666
        return semanaHTML += `
        <td scope="col"><button class="btn" id="${dia[2]}"><i class="far fa-smile-beam h2 text-color-1"></i><i class="fas fa-money-bill-wave h3 text-success"></i>
        </button></td>
        `
       } else {
        return semanaHTML += `
        <td scope="col"><button class="btn" id="${dia[2]}"><i class="fas fa-exclamation-triangle h2 text-danger"></i></button></td>
        `
       }



      })
      semanaHTML += `<td rowspan="" class=" h2" scope="col">${sumaPorSemana}</td>`

      semanaHTML += `</tr>`
      // console.log(semanaHTML)
      console.log(sumaPorSemana)

      return acc += semanaHTML

     }, '')

     // console.log(semanas_checksHTML)

     document.querySelector('#table-body-to-fill').innerHTML = semanas_checksHTML
    }

    completarTablaPorMes()

    /* ////////////////////////////////////////////// */
    /* ADD EVENT LISTENER PARA EL CLICK EN LA TABLA */
    /* ////////////////////////////////////////////// */
    document.querySelector('#table-body-to-fill').addEventListener('click', (e) => {
     e.preventDefault()
     let item = e.target
     console.log(item.parentElement.id)
     console.log(item.parentElement)

     if (item.classList[1] === 'fa-exclamation-triangle') {
      index = parseInt(item.parentElement.id)
      textIndex = item.parentElement.id
      exclamationToSmile(index)
     }
     completarTablaPorMes()

    })
    /* ////////////////////////////////////////////// */
    /* CONVERTIR DE EXCLAMACION A SMILE CON BILLETE */
    /* ////////////////////////////////////////////// */
    function exclamationToSmile(index) {
     mainData = JSON.parse(localStorage.getItem('mainData'))

     let { mayo } = mainData

     for (let semana of mayo) {
      for (let dias of semana.semana) {
       if (dias[2] === index) {
        dias[0] = 666
        console.log(dias)
       }
      }
     }
     localStorage.setItem('mainData', JSON.stringify(mainData))
    }
    /* ////////////////////////////////////////////// */
    /* CONVERTIR DE SMILE CON BILLETE A EXCLAMACION */
    /* ////////////////////////////////////////////// */
    function smileToExclamation(index) {
     mainData = JSON.parse(localStorage.getItem('mainData'))

     let { mayo } = mainData

     for (let semana of mayo) {
      for (let dias of semana.semana) {
       if (dias[2] === index) {
        dias[0] = 0
        console.log(dias)
       }
      }
     }
     localStorage.setItem('mainData', JSON.stringify(mainData))
    }





    mainData = JSON.parse(localStorage.getItem('mainData'))

    // console.log(mainData.mayo[0].semana[4][0])

    // mainData.mayo[0].semana[4][0] = 666

    // localStorage.setItem('mainData', JSON.stringify(mainData))



    /* JQUERY END */
   })




  </script>
 </div>


</body>

</html>